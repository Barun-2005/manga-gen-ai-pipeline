# MangaGen - AI Manga Generation Pipeline

A complete pipeline for generating manga panels with AI, featuring organized output management, emotion extraction, and validation systems.

## ğŸš€ Quick Start

### Single Command Pipeline
```bash
# Generate from inline prompt
python scripts/run_full_pipeline.py --prompt "ninja discovers ancient temple"

# Generate from prompt files (default)
python scripts/run_full_pipeline.py

# Generate with custom name
python scripts/run_full_pipeline.py --run-name "my_manga_story"
```

### View Results
```bash
# List recent runs
python scripts/run_full_pipeline.py --list-runs

# Browse outputs in: outputs/runs/run_YYYYMMDD_HHMMSS/
```

## ğŸ“ Project Structure

```
MangaGen/
â”œâ”€â”€ ğŸš€ scripts/
â”‚   â””â”€â”€ run_full_pipeline.py          # â­ MAIN ENTRY POINT
â”œâ”€â”€ ğŸ§  core/                          # Core pipeline modules
â”‚   â”œâ”€â”€ emotion_extractor.py          # Emotion analysis
â”‚   â”œâ”€â”€ local_flow_checker.py         # Visual flow validation
â”‚   â”œâ”€â”€ coherence_analyzer.py         # Coherence analysis
â”‚   â””â”€â”€ output_manager.py             # Output organization
â”œâ”€â”€ ğŸ¨ image_gen/                     # Image generation
â”œâ”€â”€ ğŸ¤– llm/                           # LLM integration
â”œâ”€â”€ âš™ï¸  pipeline/                      # Pipeline automation
â”œâ”€â”€ ğŸ“¦ assets/                        # Prompts and workflows
â”œâ”€â”€ âš™ï¸  config/                       # Configuration
â”œâ”€â”€ ğŸ§ª tests/                         # Test cases (protected)
â”œâ”€â”€ ğŸ“ outputs/runs/                  # â­ ORGANIZED OUTPUT
â””â”€â”€ ğŸ“¦ archive/                       # Old outputs (hidden)
```

## ğŸ¯ Features

### âœ… Complete Pipeline
- **Single Command**: Run entire pipeline with one script
- **Organized Output**: Clean folder structure per run
- **Auto Cleanup**: Configurable run retention
- **Progress Tracking**: Real-time status updates

### âœ… Panel Generation
- **Base Panels**: Standard manga style generation
- **Enhanced Panels**: Layout-enhanced with memory
- **Meaningful Names**: Descriptive filenames from prompts
- **ComfyUI Integration**: Local generation with workflow

### âœ… Analysis & Validation
- **Emotion Extraction**: Dialogue emotion analysis
- **Coherence Validation**: Panel consistency checking
- **Quality Metrics**: Automated scoring
- **Detailed Reports**: Human-readable results

### âœ… Output Management
- **Versioned Runs**: No overwrites, auto-increment
- **Clean Structure**: Everything organized per run
- **Easy Browsing**: Find results quickly
- **Configurable**: Customize retention and naming

## âš™ï¸ Configuration

Edit `config/output_config.json`:

```json
{
  "max_saved_runs": 10,
  "panel_naming_style": "descriptive",
  "auto_cleanup": true
}
```

## ğŸ§ª Testing

```bash
# Run all tests
python tests/test_pipeline.py
```

## ğŸ“‹ Usage Examples

### Basic Generation
```bash
# Simple prompt
python scripts/run_full_pipeline.py --prompt "samurai in bamboo forest"

# Custom run name
python scripts/run_full_pipeline.py --prompt "ninja adventure" --run-name "episode_01"
```

### Advanced Usage
```bash
# Custom prompt files
python scripts/run_full_pipeline.py \
  --base-prompts my_base.txt \
  --enhanced-prompts my_enhanced.txt \
  --run-name "custom_story"

# List and cleanup
python scripts/run_full_pipeline.py --list-runs
python scripts/run_full_pipeline.py --cleanup
```

### Output Structure
Each run creates:
```
outputs/runs/run_YYYYMMDD_HHMMSS/
â”œâ”€â”€ panels/
â”‚   â”œâ”€â”€ base/panel_001_scene_description.png
â”‚   â””â”€â”€ enhanced/panel_001_scene_description.png
â”œâ”€â”€ validation/scores/validation_scores_TIMESTAMP.json
â”œâ”€â”€ emotions/emotion_labels.json
â””â”€â”€ run_summary.json
```

## ğŸ”§ Requirements

- **Python 3.10+**
- **ComfyUI** running at `http://127.0.0.1:8188`
- **Dependencies**: `pip install -r requirements.txt`

## ğŸ¯ Success Criteria Met

- âœ… **Single Entry Point**: `run_full_pipeline.py` handles everything
- âœ… **Clean Output**: One folder per run with organized structure
- âœ… **No Clutter**: Auto-cleanup prevents accumulation
- âœ… **Easy Browsing**: Clear naming and organization
- âœ… **Protected Tests**: Test folder safe from cleanup
- âœ… **Archived History**: Old outputs moved to archive

## ğŸš€ Ready to Use

The pipeline is now a stable, professional tool ready for manga generation!

---

*Generated by MangaGen Pipeline v1.0*
